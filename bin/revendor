#!/bin/bash
cd `dirname $0`/..
rm -rf vendor

PROTOC_VERSION="3.5.1"
echo "Downloading protoc v${PROTOC_VERSION} for ${platform}..."

mkdir -p vendor/protoc-linux
PROTOC_URL="https://github.com/google/protobuf/releases/download/v${PROTOC_VERSION}/protoc-${PROTOC_VERSION}-linux-x86_64.zip"
wget ${PROTOC_URL} --output-document="protoc-${PROTOC_VERSION}.zip"
unzip "protoc-${PROTOC_VERSION}.zip" -d vendor/protoc-linux
rm "protoc-${PROTOC_VERSION}.zip"

mkdir -p vendor/protoc-osx
PROTOC_URL="https://github.com/google/protobuf/releases/download/v${PROTOC_VERSION}/protoc-${PROTOC_VERSION}-osx-x86_64.zip"
wget ${PROTOC_URL} --output-document="protoc-${PROTOC_VERSION}.zip"
unzip "protoc-${PROTOC_VERSION}.zip" -d vendor/protoc-osx
rm "protoc-${PROTOC_VERSION}.zip"

cd vendor
git clone https://github.com/apple/swift-protobuf
rm -rf swift-protobuf/.git